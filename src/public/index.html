<html>
  <head>
    <script src="https://sdk.mercadopago.com/js/v2"></script>
  </head>
  <body>
    <div id="cardPaymentBrick_container"></div>
    <script>
      const mp = new MercadoPago("TEST-62654c97-668a-4ca4-9f16-f049540519bc", {
        locale: "es-PE",
      });
      const bricksBuilder = mp.bricks();
      const renderCardPaymentBrick = async (bricksBuilder) => {
        const settings = {
          initialization: {
            amount: 100,
            payer: {
              email: "",
            },
          },
          customization: {
            visual: {
              style: {
                customVariables: {
                  theme: "default", // | 'dark' | 'bootstrap' | 'flat'
                },
              },
            },
            paymentMethods: {
              maxInstallments: 1,
            },
          },
          callbacks: {
            onReady: () => {
              // callback llamado cuando Brick estÃ© listo
            },
            onSubmit: (cardFormData) => {
              return new Promise((resolve, reject) => {
                fetch("/api/v1/payment", {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify(cardFormData),
                })
                  .then((response) => {
                    // recibir el resultado del pago
                    resolve();
                  })
                  .catch((error) => {
                    // tratar respuesta de error al intentar crear el pago
                    reject();
                  });
              });
            },
            onError: (error) => {
              // callback llamado para todos los casos de error de Brick
            },
          },
        };
        window.cardPaymentBrickController = await bricksBuilder.create(
          "cardPayment",
          "cardPaymentBrick_container",
          settings
        );
      };
      renderCardPaymentBrick(bricksBuilder);
    </script>
  </body>
</html>
